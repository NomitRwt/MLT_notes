<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CS2007: Machine Learning Techniques - Support Vector Machines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/Not01.html" rel="next">
<link href="../pages/Wk09.html" rel="prev">
<link href="../images/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="CS2007: Machine Learning Techniques - Support Vector Machines">
<meta property="og:description" content="">
<meta property="og:image" content="https://bsc-iitm.github.io/MLT_notes/images/Multple possible classifiers.png">
<meta property="og:site-name" content="CS2007: Machine Learning Techniques">
<meta property="og:image:height" content="841">
<meta property="og:image:width" content="960">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/Wk01.html">Notes</a></li><li class="breadcrumb-item"><a href="../pages/Wk10.html">Week-10</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/bsc-iitm/MLT_notes" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Home</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Content</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-09</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Wk10.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week-10</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Supplemental Notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-08</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Not09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial-09</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#perceptron-and-margin-maximization-in-linear-separability" id="toc-perceptron-and-margin-maximization-in-linear-separability" class="nav-link active" data-scroll-target="#perceptron-and-margin-maximization-in-linear-separability">Perceptron and Margin Maximization in Linear Separability</a>
  <ul class="collapse">
  <li><a href="#defining-key-parameters" id="toc-defining-key-parameters" class="nav-link" data-scroll-target="#defining-key-parameters">Defining Key Parameters</a></li>
  <li><a href="#observations-and-objectives" id="toc-observations-and-objectives" class="nav-link" data-scroll-target="#observations-and-objectives">Observations and Objectives</a>
  <ul class="collapse">
  <li><a href="#observations" id="toc-observations" class="nav-link" data-scroll-target="#observations">Observations</a></li>
  <li><a href="#goal-margin-maximization" id="toc-goal-margin-maximization" class="nav-link" data-scroll-target="#goal-margin-maximization">Goal: Margin Maximization</a></li>
  </ul></li>
  <li><a href="#reformulating-the-objective" id="toc-reformulating-the-objective" class="nav-link" data-scroll-target="#reformulating-the-objective">Reformulating the Objective</a>
  <ul class="collapse">
  <li><a href="#width-calculation" id="toc-width-calculation" class="nav-link" data-scroll-target="#width-calculation">Width Calculation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#constrained-optimization-and-dual-problem-in-lagrange-multipliers" id="toc-constrained-optimization-and-dual-problem-in-lagrange-multipliers" class="nav-link" data-scroll-target="#constrained-optimization-and-dual-problem-in-lagrange-multipliers">Constrained Optimization and Dual Problem in Lagrange Multipliers</a>
  <ul class="collapse">
  <li><a href="#lagrange-function" id="toc-lagrange-function" class="nav-link" data-scroll-target="#lagrange-function">Lagrange Function</a></li>
  <li><a href="#multiple-constraints" id="toc-multiple-constraints" class="nav-link" data-scroll-target="#multiple-constraints">Multiple Constraints</a></li>
  </ul></li>
  <li><a href="#formulating-the-dual-problem" id="toc-formulating-the-dual-problem" class="nav-link" data-scroll-target="#formulating-the-dual-problem">Formulating the Dual Problem</a></li>
  <li><a href="#observations-1" id="toc-observations-1" class="nav-link" data-scroll-target="#observations-1">Observations</a>
  <ul class="collapse">
  <li><a href="#observations-on-the-equation" id="toc-observations-on-the-equation" class="nav-link" data-scroll-target="#observations-on-the-equation">Observations on the Equation</a></li>
  </ul></li>
  <li><a href="#support-vector-machine-svm" id="toc-support-vector-machine-svm" class="nav-link" data-scroll-target="#support-vector-machine-svm">Support Vector Machine (SVM)</a>
  <ul class="collapse">
  <li><a href="#duality-revisited" id="toc-duality-revisited" class="nav-link" data-scroll-target="#duality-revisited">Duality Revisited</a></li>
  <li><a href="#definition-of-support-vector-machines-svms" id="toc-definition-of-support-vector-machines-svms" class="nav-link" data-scroll-target="#definition-of-support-vector-machines-svms">Definition of Support Vector Machines (SVMs)</a></li>
  <li><a href="#hard-margin-svm-algorithm" id="toc-hard-margin-svm-algorithm" class="nav-link" data-scroll-target="#hard-margin-svm-algorithm">Hard-Margin SVM Algorithm</a></li>
  </ul></li>
  <li><a href="#soft-margin-svm" id="toc-soft-margin-svm" class="nav-link" data-scroll-target="#soft-margin-svm">Soft-Margin SVM</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Support Vector Machines</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Feedback/Correction: <a href="https://forms.gle/LehGfBWFX3yWFDBH6">Click here!</a>.</p>
</div>
</div>
<p>PDF Link: <a href="../notes/Wk10.pdf">Click here!</a></p>
<section id="perceptron-and-margin-maximization-in-linear-separability" class="level1">
<h1>Perceptron and Margin Maximization in Linear Separability</h1>
<p>In this week, we explore the concept of perceptron learning in the context of linearly separable datasets with a specified margin, denoted as <span class="math inline">\(\gamma\)</span>. The dataset is defined as <span class="math inline">\(D=\{(\mathbf{x_1}, y_1), \ldots, (\mathbf{x_n},y_n)\}\)</span>, where <span class="math inline">\(\mathbf{x_i} \in \mathbb{R}^d\)</span> represents data points and <span class="math inline">\(y_i \in \{-1, 1\}\)</span> indicates their respective classes.</p>
<section id="defining-key-parameters" class="level2">
<h2 class="anchored" data-anchor-id="defining-key-parameters">Defining Key Parameters</h2>
<p>We begin by introducing essential parameters:</p>
<ol type="1">
<li><p><strong>Weight Vector</strong>: Let <span class="math inline">\(\mathbf{w^*} \in \mathbb{R}^d\)</span> be the weight vector such that <span class="math inline">\((\mathbf{w^{*T}x_i})y_i\ge\gamma\)</span> for all <span class="math inline">\(i\)</span>. This weight vector ensures the desired margin <span class="math inline">\(\gamma\)</span>.</p></li>
<li><p><strong>Bounding Radius</strong>: We define <span class="math inline">\(R&gt;0 \in \mathbb{R}\)</span> such that for all <span class="math inline">\(i\)</span>, <span class="math inline">\(||\mathbf{x_i}||\le R\)</span>. This represents a constraint on the norm of input data.</p></li>
</ol>
<p>With these parameters established, we can formulate the upper bound on the number of mistakes made by the perceptron learning algorithm: <span class="math display">\[
\text{\#mistakes} \le \frac{R^2}{\gamma^2}
\]</span></p>
</section>
<section id="observations-and-objectives" class="level2">
<h2 class="anchored" data-anchor-id="observations-and-objectives">Observations and Objectives</h2>
<section id="observations" class="level3">
<h3 class="anchored" data-anchor-id="observations">Observations</h3>
<p>We make several observations regarding the perceptron learning algorithm:</p>
<ol type="1">
<li>The “quality” of the solution depends on the margin <span class="math inline">\(\gamma\)</span>.</li>
<li>The number of mistakes is influenced by the margin associated with <span class="math inline">\(\mathbf{w^*}\)</span>.</li>
<li>The weight vector <span class="math inline">\(\mathbf{w_{perc}}\)</span> need not be identical to <span class="math inline">\(\mathbf{w^*}\)</span>.</li>
</ol>
</section>
<section id="goal-margin-maximization" class="level3">
<h3 class="anchored" data-anchor-id="goal-margin-maximization">Goal: Margin Maximization</h3>
<p>Given these observations, our overarching goal is to find the solution that maximizes the margin. It is crucial to note that a single dataset can have multiple linear classifiers with varying margins, as depicted in the diagram below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/Multple possible classifiers.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Multiple Classifiers</figcaption>
</figure>
</div>
<p>To formalize our objective, we aim to maximize the margin <span class="math inline">\(\gamma\)</span>: <span class="math display">\[
\max_{\mathbf{w},\gamma} \gamma
\]</span></p>
<p>Subject to the following constraints: <span class="math display">\[\begin{align*}
(\mathbf{w^T x_i})y_i &amp;\ge \gamma \quad \text{for all } i \\
||\mathbf{w}||^2 &amp;= 1
\end{align*}\]</span></p>
</section>
</section>
<section id="reformulating-the-objective" class="level2">
<h2 class="anchored" data-anchor-id="reformulating-the-objective">Reformulating the Objective</h2>
<p>To simplify our objective, we can express <span class="math inline">\(\gamma\)</span> in terms of the width of <span class="math inline">\(\mathbf{w}\)</span>: <span class="math display">\[
\max_{\mathbf{w}} \text{width}(\mathbf{w})
\]</span></p>
<p>Subject to the constraint: <span class="math display">\[
(\mathbf{w^T x_i})y_i \ge 1 \quad \text{for all } i
\]</span></p>
<section id="width-calculation" class="level3">
<h3 class="anchored" data-anchor-id="width-calculation">Width Calculation</h3>
<p>The width of the margin, denoted as <span class="math inline">\(\text{width}(\mathbf{w})\)</span>, can be calculated as the distance between two parallel margins. Consider two points <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{z}\)</span> lying on opposite sides of the decision boundary such that <span class="math inline">\(\mathbf{w^T x}=-1\)</span> and <span class="math inline">\(\mathbf{w^T z}=1\)</span> or vice versa.</p>
<p>Let <span class="math inline">\(\mathbf{x_1}\)</span> and <span class="math inline">\(\mathbf{x_2}\)</span> be two points on the margins and opposite sides of the decision boundary.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/Perceptron Distance.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Margin Width</figcaption>
</figure>
</div>
<p>The width is given by: <span class="math display">\[\begin{align*}
\mathbf{x_1^T w} - \mathbf{x_2^T w} &amp;= 2 \\
(\mathbf{x_1}-\mathbf{x_2})^T\mathbf{w} &amp;= 2\\
||\mathbf{x_1} - \mathbf{x_2}||_2||\mathbf{w}||_2 \cos(\theta) &amp;= 2 \\
\therefore ||\mathbf{x_1} - \mathbf{x_2}||_2 &amp;= \frac{2}{||\mathbf{w}||_2}
\end{align*}\]</span></p>
<p>Hence, our objective can be restated as: <span class="math display">\[
\max_{\mathbf{w}}  \frac{2}{||\mathbf{w}||^2_2} \quad \text{subject to} \quad (\mathbf{w^T x_i})y_i \ge 1 \quad \text{for all } i
\]</span></p>
<p>Equivalently, we can frame it as a minimization problem: <span class="math display">\[
\min_{\mathbf{w}}  \frac{1}{2}||\mathbf{w}||^2_2 \quad \text{subject to} \quad (\mathbf{w^T x_i})y_i \ge 1 \quad \text{for all } i
\]</span></p>
<p>In summary, finding the separating hyperplane with the maximum margin is equivalent to finding the one with the smallest possible normal vector <span class="math inline">\(\mathbf{w}\)</span>.</p>
</section>
</section>
</section>
<section id="constrained-optimization-and-dual-problem-in-lagrange-multipliers" class="level1">
<h1>Constrained Optimization and Dual Problem in Lagrange Multipliers</h1>
<p>In the realm of constrained optimization, we encounter problems formulated as follows: <span class="math display">\[\begin{align*}
\min_{\mathbf{w}} f(\mathbf{w}) \\
s.t. \ g(\mathbf{w}) \le 0
\end{align*}\]</span></p>
<p>To tackle such problems effectively, the method of <strong>Lagrange Multipliers</strong> comes into play. Lagrange multipliers are instrumental in solving constrained optimization problems by identifying optimal values of an objective function while adhering to a set of constraints. In this method, the constraints are seamlessly integrated into the objective function through the introduction of auxiliary variables known as Lagrange multipliers.</p>
<section id="lagrange-function" class="level2">
<h2 class="anchored" data-anchor-id="lagrange-function">Lagrange Function</h2>
<p>For the optimization problem described above, the Lagrange function, denoted as <span class="math inline">\(\mathcal{L}(\mathbf{w}, \boldsymbol{\alpha})\)</span>, is defined as follows: <span class="math display">\[
\mathcal{L}(\mathbf{w}, \boldsymbol{\alpha}) = f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w}) \quad \text{for all } \mathbf{w}
\]</span></p>
<p>Here, <span class="math inline">\(\boldsymbol{\alpha}\)</span> is a vector of Lagrange multipliers, constrained to be non-negative (<span class="math inline">\(\boldsymbol{\alpha} \ge \mathbf{0}\)</span>).</p>
<p>Maximizing the Lagrange function with respect to <span class="math inline">\(\boldsymbol{\alpha}\)</span> leads us to the following formulation: <span class="math display">\[\begin{align*}
\max_{\boldsymbol{\alpha} \ge \mathbf{0}} \mathcal{L}(\mathbf{w}, \boldsymbol{\alpha}) &amp;= \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left(f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w})\right) \\
&amp;=
\begin{cases}
\infty &amp; \text{if } g(\mathbf{w}) &gt; \mathbf{0} \\
f(\mathbf{w}) &amp; \text{if } g(\mathbf{w}) \le \mathbf{0}
\end{cases}
\end{align*}\]</span></p>
<p>Since the Lagrange function is equivalent to <span class="math inline">\(f(\mathbf{w})\)</span> when <span class="math inline">\(g(\mathbf{w}) \le \mathbf{0}\)</span>, we can rewrite our original problem as follows: <span class="math display">\[\begin{align*}
\min_{\mathbf{w}} f(\mathbf{w}) &amp;= \min_{\mathbf{w}} \left[\max_{\boldsymbol{\alpha} \ge \mathbf{0}} \mathcal{L}(\mathbf{w}, \boldsymbol{\alpha})\right] \\
&amp;= \min_{\mathbf{w}} \left[\max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left(f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w})\right)\right]
\end{align*}\]</span></p>
<p>In general, interchanging the positions of the min and max functions is not permissible unless all involved functions are convex. In our case, both <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are convex functions, allowing us to express this as: <span class="math display">\[
\min_{\mathbf{w}} \left[\max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left(f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w})\right)\right] \equiv \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[\min_{\mathbf{w}} \left(f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w})\right)\right]
\]</span></p>
</section>
<section id="multiple-constraints" class="level2">
<h2 class="anchored" data-anchor-id="multiple-constraints">Multiple Constraints</h2>
<p>Now, extending our discussion to scenarios with <span class="math inline">\(m\)</span> constraints, denoted as <span class="math inline">\(g_i(\mathbf{w}) \le \mathbf{0}\)</span> for <span class="math inline">\(i \in [1, m]\)</span>, we can represent the problem as follows: <span class="math display">\[\begin{align*}
\min_{\mathbf{w}} f(\mathbf{w}) &amp;\equiv \min_{\mathbf{w}} \left[\max_{\boldsymbol{\alpha} \ge \mathbf{0}} f(\mathbf{w}) + \sum _{i=1} ^m \alpha _i g_i(\mathbf{w})\right] \\
&amp;\equiv \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[\min_{\mathbf{w}} f(\mathbf{w}) + \sum _{i=1} ^m \alpha _i g_i(\mathbf{w})\right]
\end{align*}\]</span></p>
</section>
</section>
<section id="formulating-the-dual-problem" class="level1">
<h1>Formulating the Dual Problem</h1>
<p>To formalize the dual problem, we start with our objective function: <span class="math display">\[
\min_{\mathbf{w}}  \frac{1}{2}||\mathbf{w}||^2_2 \quad \text{s.t.} \ (\mathbf{w}^T\mathbf{x}_i)y_i \ge 1 \quad \forall i
\]</span></p>
<p>The constraints can be expressed as: <span class="math display">\[\begin{align*}
(\mathbf{w}^T\mathbf{x}_i)y_i &amp;\ge 1 \quad \forall i \\
1 - (\mathbf{w}^T\mathbf{x}_i)y_i &amp;\le 0 \quad \forall i
\end{align*}\]</span></p>
<p>Introducing Lagrange multipliers <span class="math inline">\(\boldsymbol{\alpha} \in \mathbb{R}^d\)</span>, we construct the Lagrange function: <span class="math display">\[\begin{align*}
\mathcal{L}(\mathbf{w}, \boldsymbol{\alpha}) &amp;= \frac{1}{2}||\mathbf{w}||^2_2 + \sum _{i=1} ^n \alpha _i (1 - (\mathbf{w}^T\mathbf{x}_i)y_i)
\end{align*}\]</span></p>
<p>Now, considering the duality principle, we arrive at: <span class="math display">\[\begin{align*}
\min_{\mathbf{w}} \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[\frac{1}{2}||\mathbf{w}||^2_2 + \sum _{i=1} ^n \alpha _i (1 - (\mathbf{w}^T\mathbf{x}_i)y_i)\right] &amp;\equiv \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \min_{\mathbf{w}} \left[\frac{1}{2}||\mathbf{w}||^2_2 + \sum _{i=1} ^n \alpha _i (1 - (\mathbf{w}^T\mathbf{x}_i)y_i)\right]
\end{align*}\]</span></p>
<p>Solving for the inner function of the dual problem, we obtain: <span class="math display">\[\begin{align*}
\mathbf{w}_{\boldsymbol{\alpha}}^* - \sum _{i=1} ^n \alpha _i \mathbf{x}_i y_i = 0
\end{align*}\]</span></p>
<p>This leads to a vectorized form: <span class="math display">\[
\mathbf{w}_{\boldsymbol{\alpha}}^* = \mathbf{XY}\boldsymbol{\alpha} \quad \ldots[1]
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{X} \in \mathbb{R}^{d \times n}\)</span> represents the dataset, <span class="math inline">\(\mathbf{Y} \in \mathbb{R}^{n \times n}\)</span> is a diagonal matrix with label values on its diagonals, and <span class="math inline">\(\boldsymbol{\alpha} \in \mathbb{R}^{n}\)</span>.</p>
<p>Rewriting the outer dual function, we get, <span class="math display">\[\begin{align*}
&amp;\max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[ \frac{1}{2}||\mathbf{w}||^2_2 + \sum _{i=1} ^n \alpha _i (1 - (\mathbf{w}^T\mathbf{x}_i)y_i) \right] \\
&amp;= \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[ \frac{1}{2}\mathbf{w}^T\mathbf{w} + \sum _{i=1} ^n \alpha_i -  \mathbf{w}^T\mathbf{XY}\boldsymbol{\alpha} \right] \\
&amp;= \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[ \frac{1}{2}(\mathbf{XY}\boldsymbol{\alpha})^T(\mathbf{XY}\boldsymbol{\alpha}) + \sum _{i=1} ^n \alpha_i -  (\mathbf{XY}\boldsymbol{\alpha})^T(\mathbf{XY}\boldsymbol{\alpha}) \right] \quad \ldots\text{from }[1] \\
&amp;= \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left[ \sum _{i=1} ^n \alpha_i -  \frac{1}{2}(\mathbf{XY}\boldsymbol{\alpha})^T(\mathbf{XY}\boldsymbol{\alpha}) \right] \\
\end{align*}\]</span></p>
</section>
<section id="observations-1" class="level1">
<h1>Observations</h1>
<ol type="1">
<li><p><strong>Dual and Primal Variables:</strong> The duality of the SVM problem manifests in the dimensions of its variables. The dual problem is characterized by <span class="math inline">\(\boldsymbol{\alpha} \ge \mathbf{0}\)</span>, residing in <span class="math inline">\(\mathbb{R}^n\)</span>, while the primal problem deals with <span class="math inline">\(\mathbf{w}\)</span> in <span class="math inline">\(\mathbb{R}^d\)</span>.</p></li>
<li><p><strong>Simplicity of Dual Problem:</strong> Solving the dual problem is often considered “easier” compared to the primal problem.</p></li>
<li><p><strong>Kernelization Potential:</strong> The dual problem’s dependence on <span class="math inline">\(\mathbf{X}^T\mathbf{X}\)</span> opens the door for kernelization techniques.</p></li>
</ol>
<p>Let’s now examine the equation: <span class="math display">\[
\mathbf{w}^* = \sum _{i=1} ^n \alpha _i \mathbf{x}_i y_i
\]</span></p>
<section id="observations-on-the-equation" class="level3">
<h3 class="anchored" data-anchor-id="observations-on-the-equation">Observations on the Equation</h3>
<ol type="1">
<li><p><strong>Interpreting <span class="math inline">\(\mathbf{w}^*\)</span>:</strong> The optimal <span class="math inline">\(\mathbf{w}^*\)</span> emerges as a linear combination of data points, where each data point’s significance is determined by the corresponding Lagrange multiplier <span class="math inline">\(\alpha_i\)</span>.</p></li>
<li><p><strong>Varying Importance:</strong> Consequently, some data points exert greater influence on <span class="math inline">\(\mathbf{w}^*\)</span> than others.</p></li>
</ol>
</section>
</section>
<section id="support-vector-machine-svm" class="level1">
<h1>Support Vector Machine (SVM)</h1>
<section id="duality-revisited" class="level2">
<h2 class="anchored" data-anchor-id="duality-revisited">Duality Revisited</h2>
<p>Revisiting the Lagrangian function: <span class="math display">\[
\min_{\mathbf{w}} \left [\max_{\boldsymbol{\alpha} \ge \mathbf{0}} f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w}) \right ] \equiv \max_{\boldsymbol{\alpha} \ge \mathbf{0}} \left [ \min_{\mathbf{w}} f(\mathbf{w}) + \boldsymbol{\alpha}^T g(\mathbf{w}) \right ]
\]</span></p>
<p>Here, the primal function is on the left-hand side, and the dual function is on the right. The solutions for the primal and dual functions are denoted as <span class="math inline">\(\mathbf{w}^∗\)</span> and <span class="math inline">\(\boldsymbol{\alpha}^*\)</span>, respectively. When these solutions are substituted into the equation, we obtain: <span class="math display">\[
\max_{\boldsymbol{\alpha} \ge \mathbf{0}} f(\mathbf{w}^*) + \boldsymbol{\alpha}^T g(\mathbf{w}^*) =  \min_{\mathbf{w}} f(\mathbf{w}) + \boldsymbol{\alpha}^{*T} g(\mathbf{w})
\]</span></p>
<p>Given that <span class="math inline">\(g(\mathbf{w}^*) \le \mathbf{0}\)</span>, the left-hand side simplifies to <span class="math inline">\(f(\mathbf{w}^*)\)</span>: <span class="math display">\[
f(\mathbf{w}^*) =  \min_{\mathbf{w}} f(\mathbf{w}) + \boldsymbol{\alpha}^{*T} g(\mathbf{w})
\]</span></p>
<p>Substituting <span class="math inline">\(\mathbf{w}^*\)</span> for <span class="math inline">\(\mathbf{w}\)</span> in the right-hand side yields a new right-hand side that is greater than or equal to the current one: <span class="math display">\[
f(\mathbf{w}^*) \le f(\mathbf{w}^*) + \boldsymbol{\alpha}^{*T} g(\mathbf{w}^*)
\]</span></p>
<p>Hence, we can infer: <span class="math display">\[
\boldsymbol{\alpha}^{*T} g(\mathbf{w}^*) \ge \mathbf{0}
\]</span></p>
<p>However, considering the constraints, where <span class="math inline">\(\boldsymbol{\alpha}^{*} \ge \mathbf{0}\)</span> and <span class="math inline">\(g(\mathbf{w}^*)\le \mathbf{0}\)</span>, we arrive at: <span class="math display">\[
\boldsymbol{\alpha}^{*T} g(\mathbf{w}^*) \le \mathbf{0}
\]</span></p>
<p>From this, we deduce: <span class="math display">\[
\boldsymbol{\alpha}^{*T} g(\mathbf{w}^*) = \mathbf{0}
\]</span></p>
<p>Extending this equation for multiple constraints, we obtain: <span class="math display">\[
\alpha_i^{*} g(w^*_i) = 0 \quad \forall i
\]</span></p>
<p>Hence, if one of the two values is greater than zero, the other must be zero. Considering <span class="math inline">\(g(\mathbf{w}^*) = 1-(\mathbf{w}^T\mathbf{x}_i)y_i\)</span>, we can express this as: <span class="math display">\[
\alpha_i^{*} (1-(\mathbf{w}^T\mathbf{x}_i)y_i) = 0 \quad \forall i
\]</span></p>
<p>Importantly, when <span class="math inline">\(\alpha_i &gt; \mathbf{0}\)</span>, we deduce: <span class="math display">\[
(\mathbf{w}^T\mathbf{x}_i)y_i = 1
\]</span></p>
<p>This implies that the <span class="math inline">\(i^{th}\)</span> data point resides on the <strong>“Supporting”</strong> hyperplane and significantly contributes to the determination of <span class="math inline">\(\mathbf{w}^*\)</span>.</p>
<p>Consequently, data points with <span class="math inline">\(\alpha_i &gt; \mathbf{0}\)</span> earn the title of <strong>Support Vectors</strong>, and this algorithm is known as the <strong>Support Vector Machine (SVM)</strong>.</p>
</section>
<section id="definition-of-support-vector-machines-svms" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-support-vector-machines-svms">Definition of Support Vector Machines (SVMs)</h2>
<p><strong>Support Vector Machines (SVMs)</strong> stand as a category of supervised learning algorithms designed for classification and regression analysis. SVMs aim to identify the optimal hyperplane that maximizes the margin between data points from different classes. In scenarios where data is not linearly separable, SVMs employ kernel functions to map the data into a higher-dimensional space where a linear decision boundary can effectively segregate the classes.</p>
<p><strong>Insight</strong>: <span class="math inline">\(\mathbf{w}^*\)</span> represents a sparse linear combination of data points.</p>
</section>
<section id="hard-margin-svm-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="hard-margin-svm-algorithm">Hard-Margin SVM Algorithm</h2>
<p>The Hard-Margin SVM algorithm is applicable only when the dataset is linearly separable with a margin parameter <span class="math inline">\(\gamma &gt; 0\)</span>. Its key steps include:</p>
<ol type="1">
<li><p><strong>Direct or Kernelized Calculation of Q:</strong> Compute the matrix <span class="math inline">\(Q=\mathbf{X}^T\mathbf{X}\)</span> directly or using a kernel, based on the dataset.</p></li>
<li><p><strong>Gradient Descent:</strong> Employ the gradient of the dual formula, <span class="math inline">\(\boldsymbol{\alpha}^T\mathbf{1} - \frac{1}{2}\boldsymbol{\alpha}^T\mathbf{Y}^T Q\mathbf{Y}\boldsymbol{\alpha}\)</span>, in a gradient descent algorithm to iteratively find a satisfactory set of Lagrange multipliers <span class="math inline">\(\boldsymbol{\alpha}\)</span>. Initialize <span class="math inline">\(\boldsymbol{\alpha}\)</span> as a zero vector in <span class="math inline">\(\mathbb{R}^n_+\)</span>.</p></li>
<li><p><strong>Prediction:</strong> For prediction, follow these formulas:</p>
<ul>
<li>For non-kernelized SVM:</li>
</ul>
<p><span class="math inline">\(\textbf{label}(\mathbf{x}_{\text{test}}) = \text{sign}( \mathbf{w}^T\mathbf{x}_{\text{test}}) = \text{sign}\left(\displaystyle\sum _{i=1} ^n \alpha _i y_i(\mathbf{x}_i^T\mathbf{x}_{\text{test}})\right)\)</span></p>
<ul>
<li>For kernelized SVM:</li>
</ul>
<p><span class="math inline">\(\textbf{label}(\mathbf{x}_{\text{test}}) = \text{sign}(\mathbf{w}^T\boldsymbol{\phi}(\mathbf{x}_{\text{test}})) = \text{sign}\left(\displaystyle\sum _{i=1} ^n \alpha _i y_i k(\mathbf{x}_i^T\mathbf{x}_{\text{test}})\right)\)</span></p></li>
</ol>
</section>
</section>
<section id="soft-margin-svm" class="level1">
<h1>Soft-Margin SVM</h1>
<p><strong>Soft-Margin SVM</strong> extends the standard SVM algorithm to accommodate some misclassifications in the training data. This extension is particularly useful when dealing with non-linearly separable data. It introduces a regularization parameter (<span class="math inline">\(C\)</span>) to control the balance between maximizing the margin and allowing for misclassifications.</p>
<p>The primal formulation for this extension can be expressed as: <span class="math display">\[
\min_{\mathbf{w}, \boldsymbol{\epsilon}}  \frac{1}{2}||\mathbf{w}||^2_2 + C\sum _{i=1} ^n\epsilon_i \quad s.t. \quad (\mathbf{w}^T\mathbf{x}_i)y_i + \epsilon_i \ge 1;\quad \epsilon_i \ge 0\quad \forall i
\]</span></p>
<p>Here, <span class="math inline">\(C\)</span> serves as a hyperparameter governing the trade-off between maximizing the margin and minimizing misclassifications. The additional variable <span class="math inline">\(\epsilon_i\)</span> represents the adjustment needed to satisfy the constraints.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../pages/Wk09.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week-09</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../pages/Not01.html" class="pagination-link">
        <span class="nav-page-text">Tutorial-01</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>